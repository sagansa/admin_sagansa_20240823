{
    "conflicts": [
        {
            "id": "d31452ba-eccc-44c3-8992-9ea352f2da79",
            "currentContent": "<?php\n\nnamespace App\\Filament\\Resources\\Panel\\ProductionResource\\RelationManagers;\n\nuse Filament\\Forms;\nuse Filament\\Tables;\nuse Filament\\Forms\\Form;\nuse Filament\\Tables\\Table;\nuse Filament\\Forms\\Components\\Grid;\nuse Filament\\Forms\\Components\\Select;\nuse Filament\\Tables\\Columns\\TextColumn;\nuse Illuminate\\Database\\Eloquent\\Builder;\nuse App\\Filament\\Resources\\Panel\\ProductionResource;\nuse App\\Models\\DetailInvoice;\nuse App\\Models\\ProductionMainFrom;\nuse Filament\\Resources\\RelationManagers\\RelationManager;\nuse Filament\\Tables\\Actions\\ActionGroup;\n\nclass ProductionMainFromsRelationManager extends RelationManager\n{\n    protected static string $relationship = 'productionMainFroms';\n\n    protected static ?string $recordTitleAttribute = 'created_at';\n\n    public function form(Form $form): Form\n    {\n        return $form->schema([\n            Grid::make(['default' => 1])->schema([\n\n                Select::make('detail_invoice_id')\n                    ->label('Detail Invoice')\n                    ->required()\n                    ->relationship(\n                        name: 'detailInvoice',\n                        modifyQueryUsing: fn (Builder $query) => $query\n                            // ->join('detail_requests', 'detail_invoices.detail_request_id', '=', 'detail_requests.id')\n                            // ->join('products', 'detail_requests.product_id', '=', 'products.id')\n                            ->where('detail_invoices.status', '1')\n                            // ->where('products.material_group_id', '3')\n                            ->orderBy('detail_invoices.id', 'asc'),\n                    )\n                    ->getOptionLabelFromRecordUsing(fn (DetailInvoice $record) => \"{$record->detail_invoice_name}\")\n                    ->searchable()\n                    ->preload()\n            ]),\n        ]);\n    }\n\n    public function table(Table $table): Table\n    {\n        return $table\n            ->columns([\n                TextColumn::make('detailInvoice.detailRequest.product.name'),\n                TextColumn::make('detailInvoice.quantity_product'),\n                TextColumn::make('detailInvoice.detailRequest.product.unit.unit'),\n                TextColumn::make('detailInvoice.invoicePurchase.date')\n            ])\n            ->filters([])\n            ->headerActions([Tables\\Actions\\CreateAction::make()])\n            ->actions([\n                ActionGroup::make([\n                    Tables\\Actions\\EditAction::make(),\n                    Tables\\Actions\\DeleteAction::make(),\n                ])\n            ])\n            ->bulkActions([\n                Tables\\Actions\\BulkActionGroup::make([\n                    Tables\\Actions\\DeleteBulkAction::make(),\n                ]),\n            ]);\n    }\n\n    public static function afterCreate(ProductionMainFrom $record)\n    {\n        $record->detailInvoice->update(['status' => 2]);\n    }\n}\n",
            "newContent": "<?php\n\nnamespace App\\Filament\\Resources\\Panel\\ProductionResource\\RelationManagers;\n\nuse Filament\\Forms;\nuse Filament\\Tables;\nuse Filament\\Forms\\Form;\nuse Filament\\Tables\\Table;\nuse Filament\\Forms\\Components\\Grid;\nuse Filament\\Forms\\Components\\Select;\nuse Filament\\Tables\\Columns\\TextColumn;\nuse Illuminate\\Database\\Eloquent\\Builder;\nuse App\\Filament\\Resources\\Panel\\ProductionResource;\nuse Filament\\Resources\\RelationManagers\\RelationManager;\n\nclass ProductionMainFromsRelationManager extends RelationManager\n{\n    protected static string $relationship = 'productionMainFroms';\n\n    protected static ?string $recordTitleAttribute = 'created_at';\n\n    public function form(Form $form): Form\n    {\n        return $form->schema([\n            Grid::make(['default' => 1])->schema([\n                Select::make('detail_invoice_id')\n                    ->required()\n                    ->relationship('detailInvoice', 'created_at')\n                    ->searchable()\n                    ->preload()\n                    ->native(false),\n            ]),\n        ]);\n    }\n\n    public function table(Table $table): Table\n    {\n        return $table\n            ->columns([TextColumn::make('detailInvoice.created_at')])\n            ->filters([])\n            ->headerActions([Tables\\Actions\\CreateAction::make()])\n            ->actions([\n                Tables\\Actions\\EditAction::make(),\n                Tables\\Actions\\DeleteAction::make(),\n            ])\n            ->bulkActions([\n                Tables\\Actions\\BulkActionGroup::make([\n                    Tables\\Actions\\DeleteBulkAction::make(),\n                ]),\n            ]);\n    }\n}\n"
        }
    ]
}